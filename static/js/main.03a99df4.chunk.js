(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1012:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"register",function(){return Ye}),n.d(a,"unregister",function(){return Ke});var r=n(2),o=n.n(r),l=n(15),c=n.n(l),i=n(71),s=n(168),u=(n(204),n(72)),m=(n(1018),n(506)),d=n(87),f=n.n(d),E=n(147),p=n(27),v=n(28),h=n(29),g=n(129),b=n(126),y=n(130),O=n(23),T=n.n(O);n(518),n(519);T.a.initializeApp({apiKey:"AIzaSyCopkTv3qV3lT5nE-TARB5FjBe-TwR8A8w",authDomain:"binale-software-invoicing.firebaseapp.com",databaseURL:"https://binale-software-invoicing.firebaseio.com",projectId:"binale-software-invoicing",storageBucket:"binale-software-invoicing.appspot.com",messagingSenderId:"878563105532",uploadString:"binale-software-invoicing.firebaseapp.com"});var C=T.a.firestore(),w={FOLDER:"FILE_SYSTEM_ELEMENT__FOLDER",DOCUMENT:"FILE_SYSTEM_ELEMENT__DOCUMENT"},N={DOCUMENT_IN_PROGRESS:"FILE_STATUS__DOCUMENT_IN_PROGRESS",DOCUMENT__DONE:"FILE_STATUS__DOCUMENT__DONE",TEMPLATE:"FILE_STATUS__TEMPLATE"},k="ELEMENT__TEXT",I="ELEMENT__BLOCK",x="ELEMENT__BORDER",_="ELEMENT__IMAGE",j="ELEMENT__TABLE",S=function(){},F=C.collection("documents"),R=o.a.createContext({fsItems:new Map,documents:F,parentForCreateFromTemplate:null,copiedElement:null,setParentForCreateFromTemplate:S,getFolderElementsTreeById:S,getFolderElementsById:S,getElement:S,commit:S,removeById:S,createItem:S,copyItem:S,pasteItem:S}),D=function(e){function t(){var e,n;Object(v.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(g.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).state={fsItems:new Map,parentForCreateFromTemplate:null,copiedElement:null},n.collection=C.collection("folders"),n.unsubscribe=function(){},n.getFolderElementsTreeById=function(e,t){return n.getFolderElementsById(e,t).map(function(e){if(!e.id)return e;var a=n.getFolderElementsTreeById(e.id,t);return a.length>0?Object(p.a)({},e,{children:a}):e})},n.getFolderElementsById=function(e,t){var a=[];return n.state.fsItems.forEach(function(n){var r=!t||t&&n.type===t;n.parentId===e&&r&&a.push(Object(p.a)({},n))}),a},n.getElement=function(e){return e&&n.state.fsItems.get(e)||null},n.commit=function(e){return n.collection.doc(e).update({status:N.DOCUMENT__DONE})},n.removeById=function(e){return n.collection.doc(e).delete()},n.createItem=function(){var e=Object(E.a)(f.a.mark(function e(t){var a,r,o;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.type!==w.DOCUMENT){e.next=13;break}if(a={name:t.name,content:"[[]]"},!t.formTemplate){e.next=9;break}return e.next=6,F.doc(t.documentId).get();case 6:r=e.sent,(a=r.data()).name=t.name;case 9:return e.next=11,F.add(a);case 11:o=e.sent,t.documentId=o.id;case 13:return e.next=15,n.collection.add(t);case 15:return e.abrupt("return",e.sent);case 18:throw e.prev=18,e.t0=e.catch(0),Error("File creation error "+e.t0);case 21:case"end":return e.stop()}},e,null,[[0,18]])}));return function(t){return e.apply(this,arguments)}}(),n.copyItem=function(e){n.setState({copiedElement:e})},n.pasteItem=function(){var e=Object(E.a)(f.a.mark(function e(t){var a,r,o;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.state.copiedElement){e.next=3;break}return e.abrupt("return");case 3:return r=Object(p.a)({},a,{parentId:t}),a.parentId===t&&(r.name="copy_".concat(r.name)),r.type===w.DOCUMENT&&(r.status===N.DOCUMENT__DONE&&(r.status=N.DOCUMENT_IN_PROGRESS),r.formTemplate=!0),e.next=8,n.createItem(r);case 8:return o=e.sent,n.setState({copiedElement:null}),e.abrupt("return",o);case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.setParentForCreateFromTemplate=function(e){n.setState({parentForCreateFromTemplate:e})},n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.subscribe()}},{key:"componentWillReceiveProps",value:function(e){this.subscribe()}},{key:"componentWillUnmount",value:function(){this.unsubscribe()}},{key:"render",value:function(){var e=this.state,t=e.fsItems,n=e.copiedElement,a=e.parentForCreateFromTemplate;return o.a.createElement(R.Provider,{value:{fsItems:t,documents:F,copiedElement:n,parentForCreateFromTemplate:a,setParentForCreateFromTemplate:this.setParentForCreateFromTemplate,getFolderElementsTreeById:this.getFolderElementsTreeById,getFolderElementsById:this.getFolderElementsById,getElement:this.getElement,commit:this.commit,copyItem:this.copyItem,createItem:this.createItem,pasteItem:this.pasteItem,removeById:this.removeById}},this.props.children)}},{key:"subscribe",value:function(){var e=this;this.unsubscribe(),this.unsubscribe=this.collection.onSnapshot(function(t){var n=new Map;t.forEach(function(e){var t=e.data();t.id=e.id,n.set(e.id,t)}),e.setState({fsItems:n})})}}]),t}(o.a.PureComponent);n(521);function A(e){for(var t=[],n=e.fsItems.get(e.id);;){if(!n){t.reverse();break}var a=n,r=a.id,o=a.name,l=a.parentId;t.push({path:"/dashboard/".concat(r),breadcrumbName:o,children:[]}),n=e.fsItems.get(l)}return t}function M(e,t,n){return n.indexOf(e)===n.length-1?o.a.createElement("span",null,e.breadcrumbName):o.a.createElement(s.b,{to:e.path},e.breadcrumbName)}var L,P,U=Object(i.g)(function(e){var t=e.match.params.id;t=t||"Root";var n=Object(r.useContext)(R).fsItems;return o.a.createElement(m.a,{className:"breadcrumb",itemRender:M,routes:A({fsItems:n,id:t})})}),z=n(18),B=n(175),W=n(60),G=n(55),J=n.n(G),H=n(496),V=n.n(H),Y=n(153),X="explorer",K="document",q=[{data:[{name:"new folder",value:"new_folder",icon:"folder-add"},{name:"new file",value:"new_file",icon:"file-add"},{name:"past",value:"past",icon:"profile"}],currentId:"explorer"},{data:[{name:"edit",value:"edit-template",icon:"edit"},{name:"info",value:"info",icon:"info-circle"},{name:"download",value:"download",icon:"cloud-download"},{name:"copy",value:"copy",icon:"copy"},{name:"commit",value:"commit",icon:"file-done"},{name:"delete",value:"delete",icon:"delete"}],currentId:"document"},{data:[{name:"copy",value:"copy",icon:"copy"},{name:"delete",value:"delete",icon:"delete"}],currentId:"folder"}],$=(L={},Object(W.a)(L,w.FOLDER,"folder"),Object(W.a)(L,w.DOCUMENT,"document"),L),Q=function(e){var t=$[e];if(t)return t;throw new Error("Error of FS element type: "+e)},Z=(n(259),n(117)),ee=(n(185),n(20)),te=n(41),ne=function(e){var t=e.style;return o.a.createElement(te.h,{style:t})},ae=(n(711),function(e){var t=e.style;return o.a.createElement("div",{className:"block-element",style:t})}),re=function(e){var t=e.style;return o.a.createElement(te.h,{style:t})},oe=(n(712),function(e){var t=e.style;return o.a.createElement("div",{className:"border-element",style:t})}),le=n(493),ce="1pt solid black",ie={table:{display:"flex",flexDirection:"column",border:ce,backgroundColor:"#fff",fontSize:12},header:{display:"flex",flexDirection:"row",backgroundColor:"#ccc",fontWeight:"bold"},footer:{display:"flex",flexDirection:"row",backgroundColor:"#ccc"},row:{display:"flex",flexDirection:"row"},cell:{display:"flex",padding:"2pt 6pt"}},se=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(le.a)(e),a=n[0],r=n.slice(1),o=t&&r.pop()||[];return{header:a,body:r,footer:o}},ue=function(e,t,n,a,r,l,c,i){return function(s,u,m,d){return function(f,E){var v={current:u,length:m},h={current:E,length:s.length},g=n[function(e){var t=e.row,n=e.column;return"".concat(t).concat("-").concat(n)}({row:u,column:E})]||{},b=g.colSpan,y=void 0===b?1:b,O=g.style,T=void 0===O?{}:O,C=Object(p.a)({width:"".concat(e*y,"%")},t,function(e,t,n){n=n||ce;var a={},r=e.current+1===e.length,o=t.current+1===t.length;return r||(a.borderBottom=n),o||(a.borderRight=n),a}(v,h),T);return o.a.createElement(a,{key:E,style:C,value:f,isActive:l,isDone:c,row:v.current+("body"===d?1:0),column:h.current,cellType:d,changeTable:r,actions:i})}}},me=te.f.create(ie),de=function(e){var t=e.value,n=e.style;return o.a.createElement(te.h,{style:n},o.a.createElement(te.g,null,t))},fe=function(e){var t=e.data,n=e.hasFooter,a=void 0!==n&&n,r=e.style,l=void 0===r?{}:r,c=e.cellsStyle,i=void 0===c?{}:c,s=se(t,a),u=s.header,m=s.body,d=s.footer,f=100/u.length,E=t.length,v=ue(f,me.cell,i,de);return o.a.createElement(te.h,{style:Object(p.a)({},me.table,l)},o.a.createElement(te.h,{style:me.header},u.map(v(u,0,E,"pdf"))),m.map(function(e,t){return o.a.createElement(te.h,{style:Object(p.a)({},me.row,{height:25}),key:t},e.map(v(e,t,E,"pdf")))}),d.length?o.a.createElement(te.h,{style:me.footer},d.map(v(d,E-1,E,"pdf"))):null)},Ee=(n(205),n(96)),pe=(n(109),n(39)),ve=(n(1017),n(504)),he=(n(294),n(173)),ge=(n(716),ie),be=function(e){var t=e.value,n=e.style,a=e.isActive,l=e.isDone,c=e.row,i=e.column,s=e.changeTable,u=e.cellType,m=Object(r.useState)(!1),d=Object(z.a)(m,2),f=d[0],E=d[1],p=function(){return E(!f)},v=Object(r.useRef)();Object(r.useEffect)(function(){f&&v&&v.current&&v.current.focus()},[f]);var h=function(e){s&&s(c,i,e.target.value),p()},g="header"===u?"cell header-cell":"cell";return f?o.a.createElement("div",{className:g,style:n},o.a.createElement(ve.a.Item,{className:"cell-input"},o.a.createElement(he.a.TextArea,{ref:v,autosize:!0,defaultValue:t,onPressEnter:h,onBlur:h}))):o.a.createElement("div",{className:g,style:n,onClick:function(){a&&!l&&p()}},"header"===u&&!l&&o.a.createElement("div",{className:"header-actions"},o.a.createElement(Ee.a,{placement:"top",title:"delete column"},o.a.createElement(pe.a,{type:"danger",icon:"close",size:"small",shape:"circle",onClick:function(){e.actions&&e.actions.removeColumnFromTableElement(i)}}))),o.a.createElement("span",null,t))},ye=function(e){var t=e.data,n=e.hasFooter,a=void 0!==n&&n,r=e.style,l=void 0===r?{}:r,c=e.cellsStyle,i=void 0===c?{}:c,s=e.innerRef,u=e.changeTable,m=e.actions,d=e.isActive,f=e.isDone,E=se(t,a),v=E.header,h=E.body,g=E.footer,b=100/v.length,y=t.length,O=ue(b,ge.cell,i,be,u,d,f,m);return o.a.createElement(o.a.Fragment,null,!f&&o.a.createElement("div",{className:"table-element-controls"},o.a.createElement(Ee.a,{placement:"right",title:"add row"},o.a.createElement(pe.a,{icon:"arrow-down",size:"small",shape:"circle",onClick:m.addRowToTableElement})),o.a.createElement(Ee.a,{placement:"right",title:"add column"},o.a.createElement(pe.a,{icon:"arrow-right",size:"small",shape:"circle",onClick:m.addColumnToTableElement}))),o.a.createElement("div",{ref:s,className:"table-element",style:Object(p.a)({},ge.table,l)},o.a.createElement("div",{style:ge.header},v.map(O(v,0,y,"header"))),h.map(function(e,t){return o.a.createElement("div",{className:"row",style:ge.row,key:t},!f&&o.a.createElement("div",{className:"row-actions"},o.a.createElement(Ee.a,{placement:"left",title:"delete row"},o.a.createElement(pe.a,{type:"danger",icon:"close",size:"small",shape:"circle",onClick:function(){return m.removeRowFromTableElement(t)}}))),e.map(O(e,t,y,"body")))}),g.length?o.a.createElement("div",{style:ge.footer},g.map(O(g,y-1,y,"footer"))):null))},Oe=function(e){var t=e.style,n=e.value;return o.a.createElement(te.h,{style:t},o.a.createElement(te.g,null,n))},Te=(n(755),he.a.TextArea),Ce=function(e){var t=e.style,n=e.isActive,a=e.handleChangeText,r=e.value;return o.a.createElement("div",{className:"text-element"},n?o.a.createElement(Te,{autosize:!0,value:r,style:Object(p.a)({},t,{minHeight:"100%"}),onChange:function(e){return a(e.target.value)}}):o.a.createElement("div",{style:Object(p.a)({},t)},r))},we=function(e){var t=e.style,n=e.value;return o.a.createElement(te.h,{style:t},o.a.createElement(te.b,{src:n||""}))},Ne=(n(756),function(e){var t=e.value;return o.a.createElement("div",{style:{width:"100%",height:"100%",background:"url(".concat(t,") no-repeat"),backgroundSize:"100% 100%"}})}),ke={id:"default-text",type:k,position:{x:0,y:0},size:{width:200,height:200},style:{fontSize:"16pt",color:"#000"},value:"Text"},Ie={id:"default-image",type:_,position:{x:0,y:0},size:{width:200,height:200},style:{backgroundColor:"black"},value:""},xe={id:"default-block",type:I,position:{x:0,y:0},size:{width:200,height:200},style:{backgroundColor:"#000"}},_e={id:"default-border",type:x,position:{x:0,y:0},size:{width:200,height:200},style:{border:"1pt solid #000"}},je={id:"default-table",type:j,position:{x:0,y:0},size:{width:200,height:100},hasFooter:!0,data:[["header 1","header 2"],["cell 1","cell 2"],["cell 3","cell 4"],["cell 5","cell 6"],["cell 3","cell 7"]]},Se=(P={},Object(W.a)(P,k,{control:{name:"Text",icon:"font-size",type:k},element:ke}),Object(W.a)(P,I,{control:{name:"Block",icon:"block",type:I},element:xe}),Object(W.a)(P,x,{control:{name:"Border",icon:"border",type:x},element:_e}),Object(W.a)(P,_,{control:{name:"Image",icon:"picture",type:_},element:Ie}),Object(W.a)(P,j,{control:{name:"Table",icon:"table",type:j},element:je}),P),Fe=function(e){var t=e.pages;return o.a.createElement(te.a,null,t.map(function(e,t){return o.a.createElement(te.e,{key:t},e.map(function(e,t){var n=Object(p.a)({position:"absolute",top:e.position.y,left:e.position.x,width:e.size.width,height:e.size.height},e.style);if(e.type===I)return o.a.createElement(ne,{key:t,style:n});if(e.type===x)return o.a.createElement(re,{key:t,style:n});if(e.type===k&&"value"in e)return o.a.createElement(Oe,{key:t,style:n,value:e.value});if(e.type===_&&"value"in e)return o.a.createElement(we,{key:t,style:n,value:e.value});if(e.type===j&&"hasFooter"in e){var a=e.data,r=e.hasFooter,l=e.cellsStyle;return n.top+=30,delete n.height,o.a.createElement(fe,{key:t,data:a,hasFooter:r,style:n,cellsStyle:l})}return null}))}))},Re=(n(757),Object(Y.d)(K)(function(e){var t=e.currentId,n=e.trigger,a=e.onChange,l=e.data;n&&n.item&&(n.item.status===N.DOCUMENT_IN_PROGRESS&&(l=l.filter(function(e){return"edit-template"!==e.value})),n.item.status===N.DOCUMENT__DONE&&(l=l.filter(function(e){return!["delete","commit","edit-template"].includes(e.value)})),n.item.status===N.TEMPLATE&&(l=l.filter(function(e){return!["commit","download"].includes(e.value)})));var c=Object(r.useState)([]),i=Object(z.a)(c,2),s=i[0],u=i[1],m=Object(r.useContext)(R).documents;Object(r.useEffect)(function(){if(n&&n.item){var e=m.doc(n.item.documentId).onSnapshot(function(e){var t=e.data(),n=JSON.parse(t.content);u(n)});return function(){e()}}},[m,n]);var d=n&&n.item?"".concat(n.item.name,".pdf"):"";return o.a.createElement(Y.a,{id:t,className:"context-menu"},o.a.createElement(Z.b,{selectable:!1},l.map(function(e){return o.a.createElement(Z.b.Item,{key:e.name},o.a.createElement(Y.c,{key:e.name,data:e,onClick:a},"download"===e.value?o.a.createElement(te.c,{key:e.name,document:o.a.createElement(Fe,{pages:s}),fileName:d},function(t){t.blob,t.url;var n=t.loading;return t.error,n?"Document loading...":o.a.createElement(o.a.Fragment,null,o.a.createElement(ee.a,{type:e.icon,className:"delete"===e.value?"alert":"primary"}),o.a.createElement("span",null,e.name))}):o.a.createElement(o.a.Fragment,null,o.a.createElement(ee.a,{type:e.icon,className:"delete"===e.value?"alert":"primary"}),o.a.createElement("span",null,e.name))))})))})),De=(n(420),n(255)),Ae=function(e){var t=e.open,n=e.title,a=e.content,r=e.onAction,l=e.onClose;return o.a.createElement(De.a,{visible:t,title:n,onOk:r,onCancel:l},a)},Me=n(351),Le=n.n(Me),Pe=function(e){var t=e.expanded;return o.a.createElement(J.a,{type:t?"folder-open":"folder",theme:"filled"})},Ue=function(e){var t=e.data,n=e.onSelect;return o.a.createElement(Le.a,{showIcon:!0,switcherIcon:o.a.createElement(J.a,{type:"down"}),onSelect:function(e,t){t.node.props.data&&n(t.node.props.data)}},function e(t){return t.map(function(t){return o.a.createElement(Le.a.TreeNode,{data:t,key:t.id,icon:Pe,title:t.name},t.children?e(t.children):null)})}(t))},ze=n(171),Be={CREATE_FOLDER:"CREATE_FOLDER",CREATE_DOCUMENT:"CREATE_DOCUMENT",CREATE_DOCUMENT_FROM_TEMPLATE:"CREATE_DOCUMENT_FROM_TEMPLATE"};var We=Object(ze.a)(function(){var e=Object(r.useState)(!1),t=Object(z.a)(e,2),n=t[0],a=t[1],o=Object(r.useState)(Be.CREATE_FOLDER),l=Object(z.a)(o,2),c=l[0],i=l[1],s=Object(r.useState)(null),u=Object(z.a)(s,2),m=u[0],d=u[1];return{open:n,mode:c,modalToggle:function(e,t){a(!n),i(e||Be.CREATE_FOLDER),d(t)},target:m,setTarget:d}}),Ge={open:!1,title:"",target:null,content:null};function Je(e){var t=Object(r.useContext)(R),n=(t.fsItems,Object(B.a)(t,["fsItems"])),a=n.getFolderElementsById(e),o=a.filter(function(e){return e.isDefault}),l=a.filter(function(e){return e.status===N.DOCUMENT_IN_PROGRESS}),c=a.filter(function(e){return e.status!==N.DOCUMENT_IN_PROGRESS&&!e.isDefault});return Object(p.a)({items:a,elements:[o,l,c]},n)}var He=n(155),Ve=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ye(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");Ve?(!function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Xe(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):Xe(t,e)})}}function Xe(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}function Ke(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}function qe(e){if("object"!==typeof e)throw Error("Is not an object: "+e);var t=JSON.stringify(e);try{return JSON.parse(t)}catch(n){throw Error("Error when cloning: "+n)}}var $e,Qe=595.28,Ze=841.89,et=function(e){return function(t,n){return n!==e}},tt=Symbol("pages");Object(ze.a)(Je);var nt=function(e){if(e===Be.CREATE_DOCUMENT)return"Create new document";if(e===Be.CREATE_FOLDER)return"Create new folder";if(e===Be.CREATE_DOCUMENT_FROM_TEMPLATE)return"Create document from template";throw new Error("Unknown mode: "+e)},at=Object(i.g)(function(e){var t=Object(r.useState)(""),n=Object(z.a)(t,2),a=n[0],l=n[1],c=We(),i=c.open,s=c.mode,u=c.modalToggle,m=c.target,d=Object(r.useContext)(R),p=d.fsItems,v=d.createItem,h=d.parentForCreateFromTemplate,g=e.match,b=e.history,y=function(){u(),l("")},O=function(){var e=Object(E.a)(f.a.mark(function e(){var t,n,r;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t={name:a,parentId:g.params.id,type:w.FOLDER},s!==Be.CREATE_DOCUMENT){e.next=8;break}if(n=p.get(g.params.id)){e.next=5;break}return e.abrupt("return");case 5:r="Vorlage"===n.name,t.type=w.DOCUMENT,t.status=r?N.TEMPLATE:N.DOCUMENT_IN_PROGRESS;case 8:if(s!==Be.CREATE_DOCUMENT_FROM_TEMPLATE){e.next=16;break}if(h&&h.id){e.next=11;break}return e.abrupt("return");case 11:t.parentId=h.id,t.type=w.DOCUMENT,t.status=N.DOCUMENT_IN_PROGRESS,t.formTemplate=!0,t.documentId=m.documentId;case 16:return e.prev=16,e.next=19,v(t);case 19:y(),s===Be.CREATE_DOCUMENT_FROM_TEMPLATE&&h&&b.push({pathname:"".concat(h.id)}),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(16),console.log("Error on create FS element",e.t0);case 26:case"end":return e.stop()}},e,null,[[16,23]])}));return function(){return e.apply(this,arguments)}}();return o.a.createElement(De.a,{visible:i,title:nt(s),onOk:O,onCancel:y},i&&o.a.createElement(he.a,{autoFocus:!0,onChange:function(e){l(e.target.value)}}))}),rt={}.hasOwnProperty;n(775),n(777);var ot=function(e){return function e(){for(var t=[],n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];for(var o=0,l=a;o<l.length;o++){var c=l[o];if(c){var i=typeof c;if("string"===i||"number"===i)t.push(c);else if(Array.isArray(c))t.push(e.apply(null,c));else if("object"===i)for(var s=c,u=0,m=Object.keys(s);u<m.length;u++){var d=m[u];rt.call(s,d)&&s[d]&&t.push(d)}}}return t.join(" ")}({"fs-element":!0,"in-progress":e.status===N.DOCUMENT_IN_PROGRESS})},lt=Object(i.g)(function(e){var t=e.match,n=e.history,a=Je(t.params.id),l=(a.items,a.elements),c=a.copiedElement,i=(a.parentForCreateFromTemplate,Object(B.a)(a,["items","elements","copiedElement","parentForCreateFromTemplate"])),s=function(){var e=Object(r.useState)(Ge),t=Object(z.a)(e,2),n=t[0],a=t[1];return[n,{setModalState:function(e){a(e)},closeModal:function(){a(Object(p.a)({},Ge))}}]}(),u=Object(z.a)(s,2),m=u[0],d=u[1],v=We().modalToggle,h=function(e){return function(){if(e.type===w.FOLDER)n.push({pathname:"".concat(e.id)});else if(e.status===N.TEMPLATE){var t={item:e,name:"new_file_from_template",value:"new_file_from_template"};d.setModalState({open:!0,title:"Create document from template",target:t,content:o.a.createElement(Ue,{data:i.getFolderElementsTreeById("Root",w.FOLDER),onSelect:i.setParentForCreateFromTemplate})})}else n.push("/document/".concat(e.id))}},g=function(e,a){switch(a.value){case"new_file":return v(Be.CREATE_DOCUMENT);case"new_folder":return v(Be.CREATE_FOLDER);case"edit-template":return n.push("/document/".concat(a.item.id));case"past":return i.pasteItem(t.params.id);case"delete":if(a.item.isDefault)return;return d.setModalState({open:!0,title:"Are you sure you want to delete?",target:a});case"download":return console.log("download",e,a);case"info":var r=o.a.createElement(V.a,{size:"small",bordered:!0,showHeader:!1,pagination:!1,columns:[{dataIndex:"title"},{dataIndex:"date"}],dataSource:[{title:"Created",date:"19.02.2019"},{title:"Updated",date:"19.02.2019"}]});return d.setModalState({open:!0,title:"Document information",target:a,content:r});case"copy":return i.copyItem(a.item);case"commit":return d.setModalState({open:!0,title:"Are you sure you want to commit?",target:a});default:return}},b=function(){var e=Object(E.a)(f.a.mark(function e(){var t,n,a,r;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(m.target){e.next=2;break}return e.abrupt("return");case 2:if(t=m.target,n=t.value,a=t.name,r=t.item,n&&r){e.next=5;break}return e.abrupt("return");case 5:if(e.prev=5,"delete"!==n){e.next=9;break}return e.next=9,i.removeById(r.id);case 9:if("commit"!==n){e.next=12;break}return e.next=12,i.commit(r.id);case 12:"new_file_from_template"===n&&v(Be.CREATE_DOCUMENT_FROM_TEMPLATE,r),d.closeModal(),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),console.log("Error on ".concat(a," FS element"),e.t0);case 19:case"end":return e.stop()}},e,null,[[5,16]])}));return function(){return e.apply(this,arguments)}}();return o.a.createElement(Y.b,{id:X},o.a.createElement("div",{className:"explorer"},l.map(function(e,t){return o.a.createElement("div",{key:t,className:"root"},e.map(function(e){return o.a.createElement(Y.b,{key:e.id,collect:function(t){return Object(p.a)({},t,{item:e})},id:e.isDefault?"":Q(e.type)},o.a.createElement("div",{className:ot(e),onClick:h(e)},function(e){var t,n="sync";e.status===N.TEMPLATE&&(n="layout"),e.status===N.DOCUMENT__DONE&&(n="check-circle");var a="lock";return"Vorlage"===e.name&&(a="layout"),(t={},Object(W.a)(t,w.FOLDER,o.a.createElement(o.a.Fragment,null,e.isDefault&&o.a.createElement(J.a,{className:"marker",type:a}),o.a.createElement(J.a,{className:"icon folder",type:"folder",theme:"filled"}))),Object(W.a)(t,w.DOCUMENT,o.a.createElement(o.a.Fragment,null,o.a.createElement(J.a,{className:"marker doc",type:n}),o.a.createElement(J.a,{className:"icon",type:"file",theme:"filled"}))),t)[e.type]}(e),o.a.createElement("span",{className:"text"},e.name)))}))})),q.map(function(e){var n=e.data,a=i.getElement(t.params.id),r=!!a&&"Vorlage"===a.name;return e.currentId===X&&(n=e.data.filter(function(e){return"past"!==e.value||c&&(c.status!==N.TEMPLATE&&!r||c.status===N.TEMPLATE&&r)})),o.a.createElement(Re,{key:e.currentId,data:n,currentId:e.currentId,onChange:g})}),o.a.createElement(at,null),o.a.createElement(Ae,{open:m.open,title:m.title,content:m.content,onAction:b,onClose:d.closeModal}))}),ct=n(498),it=n.n(ct),st=(n(839),function(e){var t=Object(r.useState)(!1),n=Object(z.a)(t,2),a=n[0],l=n[1],c=We().modalToggle;return o.a.createElement(u.a.Sider,{collapsible:!0,collapsed:a,onCollapse:l},o.a.createElement(s.b,{to:"/",className:"logoContainer"},o.a.createElement("img",{className:"logo",alt:"logo",src:it.a}),"binale".split("").map(function(e,t){return o.a.createElement("span",{key:t,className:"logoText"},e)})),o.a.createElement(Z.b,{theme:"dark",selectable:!1,onClick:function(e){"file"===e.key&&c(Be.CREATE_DOCUMENT),"folder"===e.key&&c(Be.CREATE_FOLDER)}},[{key:"folder",text:"New folder",icon:"folder-add"},{key:"file",text:"New document",icon:"file-add"}].map(function(e){return o.a.createElement(Z.b.Item,{key:e.key},o.a.createElement(ee.a,{type:e.icon}),o.a.createElement("span",null,e.text))})))}),ut=(n(840),function(e){return o.a.createElement(u.a,{className:"layout"},o.a.createElement(st,null),e.children)}),mt=(n(841),function(e){return o.a.createElement(ut,null,o.a.createElement(u.a,{className:"dashboard"},o.a.createElement(u.a.Header,{className:"header"}),o.a.createElement(u.a.Content,{className:"content"},o.a.createElement(U,null),o.a.createElement("div",{className:"main"},o.a.createElement(lt,null))),o.a.createElement(u.a.Footer,{className:"footer"},"Binale Software \xa92019")))}),dt=n(172),ft=n(505),Et=Object(ze.a)(function(e){var t=Object(r.useContext)(R),n=t.getElement,a=t.documents,o=n(e.fsElementId),l=!!o&&o.status===N.DOCUMENT__DONE,c=Object(r.useState)([[]]),i=Object(z.a)(c,2),s=i[0],u=i[1];window[tt]=s,Object(r.useEffect)(function(){if(o){var e=a.doc(o.documentId).onSnapshot(function(e){console.log("subscribe");var t=e.data(),n=JSON.parse(t.content);Array.isArray(n)&&u(n)});return $e=setInterval(function(){var e=JSON.stringify(window[tt]);a.doc(o.documentId).update({content:e}),console.log("Document was updated")},5e3),function(){e(),clearInterval($e),console.log("unsubscribe")}}},[o,a]);var m=Object(r.useState)(null),d=Object(z.a)(m,2),f=d[0],E=d[1],v=function(){return E(null)},h=function(e){return!!f&&f.id===e.id},g=Object(r.useState)(null),b=Object(z.a)(g,2),y=b[0],O=b[1],T=function(e,t,n,a){var r=qe(Se[t].element);if(!r)throw new Error("Unknown element type: "+t);var o=r.size,l=Qe<n.x+o.width?Qe-o.width:n.x,c=Ze<n.y+o.height?Ze-o.height:n.y;r.position={x:l,y:c},r.id="f".concat((+new Date).toString(16)),a&&"value"in r&&(r.value=a);var i=s[e];s[e]=[].concat(Object(He.a)(i),[r]),u(Object(He.a)(s))},C=function(e,t,n){s[e][t]=Object(p.a)({},n),u(Object(He.a)(s))},w=Object(r.useState)(!1),k=Object(z.a)(w,2),I=k[0],x=k[1];return{activeId:y,activeElement:f,pages:s,isDone:l,showPreview:I,actions:{addPage:function(){return u([].concat(Object(He.a)(s),[[]]))},deletePage:function(e){u(s.filter(et(e)))},addElement:T,changeElement:C,deleteElement:function(e,t){s[e]=s[e].filter(et(t)),u(Object(He.a)(s))},setActiveElement:function(e){h(e)?v():E(e)},resetActiveElement:v,isElementActive:h,addRowToTableElement:function(e,t,n){var a=n.data,r=n.hasFooter,o=a.length-(r?1:0),l=a[o].map(function(e){return"cell"});n.data.splice(o,0,l),C(e,t,n)},addColumnToTableElement:function(e,t,n){var a=n.data;n.data=a.map(function(e){return[].concat(Object(He.a)(e),["cell"])}),C(e,t,n)},removeRowFromTableElement:function(e,t,n,a){var r=qe(n.data);r.splice(a,1),n.data=r,C(e,t,n)},removeColumnFromTableElement:function(e,t,n,a){var r=qe(n.data);r.forEach(function(e){return e.splice(a,1)}),n.data=r,C(e,t,n)},togglePreview:function(){return x(!I)},handleChangeText:function(e,t,n,a){a.value=n,C(e,t,a)},changeTextStyle:function(e,t,n,a,r){"underline"===r.style[n]&&(a="none"),"italic"===r.style[n]&&(a="normal"),"bold"===r.style[n]&&(a="normal"),"fontSize"===n&&(a="".concat(a,"pt")),r.style[n]=a,C(e,t,r)},setActiveId:function(e,t){return O({page:e,id:t})},resetActiveId:function(){return O(null)},handleChangeSettings:function(e,t,n,a,r){var o=qe(f);o&&("border"===n?o[r].border="1pt solid ".concat(a):o[r][n]=a,C(e,t,o))},addImage:function(e,t,n){var a=document.createElement("input");a.type="file";var r={},o="";a.onchange=function(a){var l=new FileReader;r=a.target.files[0],l.onload=function(a){o=a.target.result,T(e,t,n,o)},l.readAsDataURL(r)},a.click()}}}}),pt=(n(448),n(154)),vt=n(341),ht=n.n(vt),gt=(n(914),{position:"absolute",zIndex:"2"}),bt={position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"},yt=function(e){var t=e.handleChangeSettings,n=e.activeElement,a=n.size,l=n.position,c=n.style,i=n.type,s=Object(r.useState)(!1),u=Object(z.a)(s,2),m=u[0],d=u[1],f=function(e,t){return e===I?{type:"backgroundColor",color:t.backgroundColor}:e===x?{type:"border",color:t.border.split(" ")[2]}:null}(i,c);return o.a.createElement("div",{className:"block-settings-editor"},o.a.createElement("div",{className:"fields"},o.a.createElement("span",null,"Width:"),o.a.createElement(pt.a,{value:a.width,size:"small",onChange:function(e){return t("width",e,"size")}})),o.a.createElement("div",{className:"fields"},o.a.createElement("span",null,"Height:"),o.a.createElement(pt.a,{value:a.height,size:"small",onChange:function(e){return t("height",e,"size")}})),o.a.createElement("div",{className:"fields"},o.a.createElement("span",null,"X:"),o.a.createElement(pt.a,{value:l.x,size:"small",onChange:function(e){return t("x",e,"position")}})),o.a.createElement("div",{className:"fields"},o.a.createElement("span",null,"Y:"),o.a.createElement(pt.a,{value:l.y,size:"small",onChange:function(e){return t("y",e,"position")}})),f&&o.a.createElement(o.a.Fragment,null,o.a.createElement(pe.a,{icon:"bg-colors",className:"icon-settings",onClick:function(){d(!m)}}),m?o.a.createElement("div",{style:gt},o.a.createElement("div",{style:bt,onClick:function(){d(!1)}}),o.a.createElement(ht.a,{color:f,onChangeComplete:function(e){return t(f.type,e.hex,"style")}})):null))},Ot=(n(915),function(){var e=Et(),t=e.pages,n=e.actions,a=e.activeId,r=e.activeElement,l=e.isDone;return o.a.createElement("div",{className:"editor-container"},o.a.createElement(pe.a.Group,null,!l&&o.a.createElement(pe.a,{onClick:n.addPage},o.a.createElement(ee.a,{type:"file",theme:"filled"}),"Add page"),o.a.createElement(te.c,{document:o.a.createElement(Fe,{pages:t}),fileName:"somename.pdf"},function(e){e.blob,e.url;var t=e.loading;e.error;return t?"Loading document...":o.a.createElement(pe.a,null,"Save",o.a.createElement(ee.a,{type:"save",theme:"filled"}))}),!l&&o.a.createElement(pe.a,{onClick:n.togglePreview},"Preview",o.a.createElement(ee.a,{type:"eye",theme:"filled"}))),!l&&!!r&&o.a.createElement("div",{className:"editor-settings"},function(e,t){return{block:o.a.createElement(yt,{activeElement:e,handleChangeSettings:t})}}(r,function(e,t,o){n.handleChangeSettings(a.page,a.id,e,t,o,r)}).block))}),Tt=(n(916),"DND_CONTROL_TYPE__BOX"),Ct=function(e){var t=e.control,n=Object(dt.c)({item:{type:Tt,element:t.type}}),a=Object(z.a)(n,2)[1];return o.a.createElement("div",null,o.a.createElement("div",{className:"element-control",ref:a},o.a.createElement(ee.a,{type:t.icon}),o.a.createElement("span",{className:"text"},t.name)))},wt=n(501),Nt=n(503),kt=(n(952),[{icon:"align-left",style:"textAlign",value:"left"},{icon:"align-center",style:"textAlign",value:"center"},{icon:"align-right",style:"textAlign",value:"right"},{icon:"underline",style:"textDecoration",value:"underline"},{icon:"bold",style:"fontWeight",value:"bold"},{icon:"italic",style:"fontWeight",value:"italic"}]),It={position:"absolute",zIndex:"2"},xt={position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"},_t=function(e){var t=e.changeTextStyle,n=e.element.style,a=Object(r.useState)(!1),l=Object(z.a)(a,2),c=l[0],i=l[1];return o.a.createElement("div",{className:"text-settings-root"},o.a.createElement("div",{className:"font-setting"},o.a.createElement(ee.a,{type:"font-size",className:"icon-settings"}),o.a.createElement(pt.a,{value:n.fontSize,onChange:function(e){return t("fontSize",e)}})),o.a.createElement(pe.a,{icon:"font-colors",className:"icon-settings",onClick:function(){i(!c)}}),c?o.a.createElement("div",{style:It},o.a.createElement("div",{style:xt,onClick:function(){i(!1)}}),o.a.createElement(Nt.ChromePicker,{color:n.color,onChangeComplete:function(e){return t("color",e.hex)}})):null,kt.map(function(e,n){return o.a.createElement(pe.a,{icon:e.icon,key:n,className:"icon-settings",onClick:function(){return t(e.style,e.value)}})}))},jt=(n(464),function(e,t){return t.type===j&&e.current?e.current.getBoundingClientRect().height:t.size.height}),St=function(e,t){var n={bottom:!1,bottomLeft:!1,bottomRight:!1,right:!1,left:!1,top:!1,topLeft:!1,topRight:!1};return e===j?(n.right=!t,n):t?n:void 0},Ft=function(e){var t=e.id,n=e.pageIndex,a=e.element,l=Et(),c=l.isDone,i=l.activeElement,s=l.actions,u=i&&i.type===k,m=Object(r.useRef)(),d=a.position,f=a.size,E=s.isElementActive(a),p=c?"":"dnd-box";return o.a.createElement(wt.a,{className:p,bounds:"parent",position:d,size:{width:f.width,height:jt(m,a)},onClick:function(e){return function(e){return e.stopPropagation()}(e)},onDoubleClick:function(e){s.setActiveElement(a),s.setActiveId(n,t)},disableDragging:E||c,onDragStop:function(e,r){a.position.x=r.x,a.position.y=r.y,s.changeElement(n,t,a)},enableResizing:St(a.type,c),onResizeStop:function(e,r,o,l,c){var i=o.getBoundingClientRect(),u=i.width,m=i.height;a.position.x=c.x,a.position.y=c.y,a.size.width=u,a.size.height=m,s.changeElement(n,t,a)}},!c&&E&&o.a.createElement(Ee.a,{className:"remove-btn",placement:"right",title:"delete"},o.a.createElement(pe.a,{type:"danger",icon:"close",size:"small",shape:"circle",onClick:function(){return s.deleteElement(n,t)}})),!c&&E&&u&&o.a.createElement(_t,{changeTextStyle:function(e,r){s.changeTextStyle(n,t,e,r,a)},element:a}),function(e,t,n,a,r,l,c,i,s,u){if(!e)return null;if(e.type===I)return o.a.createElement(ae,{style:e.style});if(e.type===x)return o.a.createElement(oe,{style:e.style});if(e.type===j&&"hasFooter"in e){var m=e.data,d=e.hasFooter,f=e.style,E=e.cellsStyle;return o.a.createElement(ye,{innerRef:t,data:m,hasFooter:d,style:f,cellsStyle:E,isActive:i,isDone:s,changeTable:n,actions:{addRowToTableElement:a,addColumnToTableElement:r,removeRowFromTableElement:l,removeColumnFromTableElement:c}})}return e.type===_&&"value"in e?o.a.createElement(Ne,{style:e.style,value:e.value}):e.type===k&&"value"in e?o.a.createElement(Ce,{style:e.style,isActive:i,value:e.value,handleChangeText:u}):void 0}(a,m,function(e,r,o){a.data[e][r]=o,s.changeElement(n,t,a)},function(){s.addRowToTableElement(n,t,a)},function(){s.addColumnToTableElement(n,t,a)},function(e){s.removeRowFromTableElement(n,t,a,e)},function(e){s.removeColumnFromTableElement(n,t,a,e)},E,c,function(e){s.handleChangeText(n,t,e,a)}))},Rt=function(e){var t=e.pageIndex,n=e.page,a=e.isDone,l=e.actions,c=Object(r.useState)(document.body.getBoundingClientRect()),i=Object(z.a)(c,2),s=i[0],u=i[1],m=Object(r.useState)(s.top),d=Object(z.a)(m,2),f=d[0],E=d[1],p=Object(r.useRef)(),v=Object(dt.d)({accept:Tt,drop:function(e,n){var a=n.getClientOffset();if(g&&a){a.x=a.x-p.current.offsetLeft,a.y=a.y-p.current.offsetTop+f,e.element===_?l.addImage(t,e.element,a):l.addElement(t,e.element,a);n.didDrop()}},collect:function(e){return{isOver:e.isOver(),isOverCurrent:e.isOver({shallow:!0})}}}),h=Object(z.a)(v,2),g=h[0],b=h[1],y=function(){u(document.body.getBoundingClientRect()),E(-s.top)};return Object(r.useEffect)(function(){return window.addEventListener("scroll",y),function(){window.removeEventListener("scroll",y)}}),o.a.createElement("div",{className:"list-container",ref:b,onClick:function(){l.resetActiveElement(),l.resetActiveId()}},o.a.createElement("div",{className:"list",ref:p},0!==t&&!a&&o.a.createElement(Ee.a,{className:"remove-page",placement:"right",title:"delete"},o.a.createElement(pe.a,{type:"danger",icon:"close",size:"small",shape:"circle",onClick:function(){return l.deletePage(t)}})),n.map(function(e,n){return o.a.createElement(Ft,{key:n,id:n,pageIndex:t,element:e})}),o.a.createElement("span",{className:"page"},t+1)))},Dt=function(e){var t=e.pages,n=e.showPreview;return o.a.createElement("div",{className:"left-panel"},Object.values(Se).map(function(e){var t=e.control;return o.a.createElement(Ct,{key:t.name,control:t})}),n&&o.a.createElement(te.d,{className:"pdf-viewer"},o.a.createElement(Fe,{pages:t})))},At=(n(953),function(){var e=Et(),t=e.pages,n=e.isDone,a=e.showPreview,r=e.actions;return o.a.createElement(u.a,{className:"document"},o.a.createElement(u.a.Header,{className:"header"},o.a.createElement(U,null)),o.a.createElement(u.a.Content,{className:"content"},o.a.createElement(dt.b,{backend:ft.a},!n&&o.a.createElement(Dt,{pages:t,showPreview:a}),o.a.createElement("div",{className:"pages"},t.map(function(e,t){return o.a.createElement(Rt,{key:t,pageIndex:t,page:e,actions:r,isDone:n})})),o.a.createElement(Ot,null))),o.a.createElement(u.a.Footer,{className:"footer"},"Binale Software \xa92019"))}),Mt=function(e){var t=e.match.params;return o.a.createElement(Et.Provider,{fsElementId:t.id},o.a.createElement(At,null))};function Lt(e){return o.a.createElement(i.a,{to:"/dashboard/Root"})}n(954),n(955);c.a.render(o.a.createElement(D,null,o.a.createElement(We.Provider,null,o.a.createElement(function(){return o.a.createElement(s.a,null,o.a.createElement(i.b,{exact:!0,path:"/",render:Lt}),o.a.createElement(i.d,null,o.a.createElement(i.b,{path:"/dashboard/:id",component:mt}),o.a.createElement(i.b,{path:"/document/:id",component:Mt})))},null))),document.getElementById("root")),a.unregister()},464:function(e,t,n){},498:function(e,t,n){e.exports=n.p+"static/media/logo.2fcb8508.png"},507:function(e,t,n){e.exports=n(1012)},521:function(e,t,n){},578:function(e,t){},580:function(e,t){},617:function(e,t){},618:function(e,t){},711:function(e,t,n){},712:function(e,t,n){},716:function(e,t,n){},755:function(e,t,n){},756:function(e,t,n){},757:function(e,t,n){},777:function(e,t,n){},839:function(e,t,n){},840:function(e,t,n){},841:function(e,t,n){},914:function(e,t,n){},915:function(e,t,n){},916:function(e,t,n){},952:function(e,t,n){},953:function(e,t,n){},954:function(e,t,n){}},[[507,1,2]]]);
//# sourceMappingURL=main.03a99df4.chunk.js.map